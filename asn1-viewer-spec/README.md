# asn1 viewer

This is a small spec and minimal functional requirement.

# ASN1

## What is asn1?

[ASN1 (Abstract Syntax Notation One)](https://en.wikipedia.org/wiki/ASN.1):

> is a standard interface description language (IDL) for defining data structures that can be serialized and deserialized in a cross-platform way.
> It is broadly used in telecommunications and computer networking, and especially in cryptography.

In short: asn1 is a special language for **defining structures**.

## Serialization/Deserialization?

But how do we serialize and deserialize these structures? There are many ways. Exist asn1 extensions that define rules for serialization/deserialization: asn1 der, asn1 ber, asn1 xml, and so on. But you don't need them all. Today we will focus only on `asn1 der`.

To understand the encoding rules, I recommend reading this article: [A Warm Welcome to ASN.1 and DER](https://letsencrypt.org/docs/a-warm-welcome-to-asn1-and-der/#the-encoding).

## Usage

Have you even seen any x509 certificates? I hope so. If no, then here is an example:

```txt
-----BEGIN CERTIFICATE-----
MIIFhTCCBG2gAwIBAgITHAAAAAQxCE+sGN6a4wAAAAAABDANBgkqhkiG9w0BAQsF
ADBLMRMwEQYKCZImiZPyLGQBGRYDY29tMRMwEQYKCZImiZPyLGQBGRYDdGJ0MR8w
HQYDVQQDExZ0YnQtV0lOLTk1NkNRT1NTSlRGLUNBMB4XDTI0MDIyMDIzNTI1N1oX
DTI1MDIxOTIzNTI1N1owADCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEB
AJ00MTGuGhl5P64ImcfGQKIs3R+hqDwlkNshrLry4KdHoBRg6lNJhlZ7TUdI3dMf
67WL1GMXLVOXhLlj5T8xBIDxPCLL280JZmUjA7BCgNGAnZHIgcO+wceshXiIuu79
D8tq7ZLGP105uPj44shPyxeMssHP2DEvnS+XHej1MnfD6AzNQ7Tww8bkQsebfoMD
Og+RzmeWsWsAyENuYBBEZaOVWQ3Hlqv9RJrZdoaIgEOE3L9+Oc6YR2dP63oe8joB
/JsTn3MxaVwqw/awZkxGTNx22iL39efpINlFlj1tFM67JpMvhaGowjGeMw3xMhdk
NN5MlVQHmybc2uFFr+cCjJ0CAwEAAaOCAqswggKnMD0GCSsGAQQBgjcVBwQwMC4G
JisGAQQBgjcVCIX6r0CFv7wWhIGPKIKV+lSGo6d/NIK2wQ+E+tJbAgFkAgECMB8G
A1UdJQQYMBYGCisGAQQBgjcUAgIGCCsGAQUFBwMCMA4GA1UdDwEB/wQEAwIFoDAp
BgkrBgEEAYI3FQoEHDAaMAwGCisGAQQBgjcUAgIwCgYIKwYBBQUHAwIwHQYDVR0O
BBYEFPEzFpOM5j5PtsqhmITshH4uqOgHMCgGA1UdEQEB/wQeMBygGgYKKwYBBAGC
NxQCA6AMDAp0MkB0YnQuY29tMB8GA1UdIwQYMBaAFPism564p7aTWMNGJ3pmWTRw
y0CtMIHYBgNVHR8EgdAwgc0wgcqggceggcSGgcFsZGFwOi8vL0NOPXRidC1XSU4t
OTU2Q1FPU1NKVEYtQ0EsQ049V0lOLTk1NkNRT1NTSlRGLENOPUNEUCxDTj1QdWJs
aWMlMjBLZXklMjBTZXJ2aWNlcyxDTj1TZXJ2aWNlcyxDTj1Db25maWd1cmF0aW9u
LERDPXRidCxEQz1jb20/Y2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdD9iYXNlP29i
amVjdENsYXNzPWNSTERpc3RyaWJ1dGlvblBvaW50MIHEBggrBgEFBQcBAQSBtzCB
tDCBsQYIKwYBBQUHMAKGgaRsZGFwOi8vL0NOPXRidC1XSU4tOTU2Q1FPU1NKVEYt
Q0EsQ049QUlBLENOPVB1YmxpYyUyMEtleSUyMFNlcnZpY2VzLENOPVNlcnZpY2Vz
LENOPUNvbmZpZ3VyYXRpb24sREM9dGJ0LERDPWNvbT9jQUNlcnRpZmljYXRlP2Jh
c2U/b2JqZWN0Q2xhc3M9Y2VydGlmaWNhdGlvbkF1dGhvcml0eTANBgkqhkiG9w0B
AQsFAAOCAQEALrbljamlyCDGcTjdpwlaxuoB24J9Y2mBSS54XvLha0pqTalSbB7r
YxUfRQHfwdgsT/enIr0YENxOucU6XaYMqJPijBl9IxPAZtryCdpfq2JbSAYcYWZA
M6ileb9+IwzN1YkgMoP0ePQnJnLWla8DwlypBb3RL8gPq1Tgh657BnLDI/KtxXXh
zjc8F65e62X/tiZTYF3arzUi8d/27fTMMu31Q15wbyc0nqPshWqeREjIBgJANLDr
edzacfkktFMYP3SzKCjmdv2Agpk2UJj4YHqR6PM4HWEEMbZsccLup94eX7e07LbN
LgknOHB11/STJXk6S1WOo34heqPVKJQc9w==
-----END CERTIFICATE-----
```

If you decode the base64 data, then you will get the asn1 encoded structure that describes the x509 certificate. You can use these tool to visualize the asn1 data:

* [crypto.qkation.com/asn1](https://crypto.qkation.com/asn1/?asn1=308205853082046da00302010202131c0000000431084fac18de9ae3000000000004300d06092a864886f70d01010b0500304b31133011060a0992268993f22c6401191603636f6d31133011060a0992268993f22c6401191603746274311f301d060355040313167462742d57494e2d39353643514f53534a54462d4341301e170d3234303232303233353235375a170d3235303231393233353235375a300030820122300d06092a864886f70d01010105000382010f003082010a02820101009d343131ae1a19793fae0899c7c640a22cdd1fa1a83c2590db21acbaf2e0a747a01460ea534986567b4d4748ddd31febb58bd463172d539784b963e53f310480f13c22cbdbcd0966652303b04280d1809d91c881c3bec1c7ac857888baeefd0fcb6aed92c63f5d39b8f8f8e2c84fcb178cb2c1cfd8312f9d2f971de8f53277c3e80ccd43b4f0c3c6e442c79b7e83033a0f91ce6796b16b00c8436e60104465a395590dc796abfd449ad9768688804384dcbf7e39ce9847674feb7a1ef23a01fc9b139f7331695c2ac3f6b0664c464cdc76da22f7f5e7e920d945963d6d14cebb26932f85a1a8c2319e330df132176434de4c9554079b26dcdae145afe7028c9d0203010001a38202ab308202a7303d06092b06010401823715070430302e06262b060104018237150885faaf4085bfbc1684818f288295fa5486a3a77f3482b6c10f84fad25b020164020102301f0603551d2504183016060a2b06010401823714020206082b06010505070302300e0603551d0f0101ff0404030205a0302906092b060104018237150a041c301a300c060a2b060104018237140202300a06082b06010505070302301d0603551d0e04160414f13316938ce63e4fb6caa19884ec847e2ea8e80730280603551d110101ff041e301ca01a060a2b060104018237140203a00c0c0a7432407462742e636f6d301f0603551d23041830168014f8ac9b9eb8a7b69358c346277a66593470cb40ad3081d80603551d1f0481d03081cd3081caa081c7a081c48681c16c6461703a2f2f2f434e3d7462742d57494e2d39353643514f53534a54462d43412c434e3d57494e2d39353643514f53534a54462c434e3d4344502c434e3d5075626c69632532304b657925323053657276696365732c434e3d53657276696365732c434e3d436f6e66696775726174696f6e2c44433d7462742c44433d636f6d3f63657274696669636174655265766f636174696f6e4c6973743f626173653f6f626a656374436c6173733d63524c446973747269627574696f6e506f696e743081c406082b060105050701010481b73081b43081b106082b060105050730028681a46c6461703a2f2f2f434e3d7462742d57494e2d39353643514f53534a54462d43412c434e3d4149412c434e3d5075626c69632532304b657925323053657276696365732c434e3d53657276696365732c434e3d436f6e66696775726174696f6e2c44433d7462742c44433d636f6d3f634143657274696669636174653f626173653f6f626a656374436c6173733d63657274696669636174696f6e417574686f72697479300d06092a864886f70d01010b050003820101002eb6e58da9a5c820c67138dda7095ac6ea01db827d636981492e785ef2e16b4a6a4da9526c1eeb63151f4501dfc1d82c4ff7a722bd1810dc4eb9c53a5da60ca893e28c197d2313c066daf209da5fab625b48061c61664033a8a579bf7e230ccdd589203283f478f4272672d695af03c25ca905bdd12fc80fab54e087ae7b0672c323f2adc575e1ce373c17ae5eeb65ffb62653605ddaaf3522f1dff6edf4cc32edf5435e706f27349ea3ec856a9e4448c806024034b0eb79dcda71f924b453183f74b32828e676fd808299365098f8607a91e8f3381d610431b66c71c2eea7de1e5fb7b4ecb6cd2e0927387075d7f49325793a4b558ea37e217aa3d528941cf7)

![image](https://github.com/user-attachments/assets/5bf271d9-814a-467d-afca-d6e2d087947a)

* [https://lapo.it/asn1js/](https://lapo.it/asn1js/#MIIFhTCCBG2gAwIBAgITHAAAAAQxCE-sGN6a4wAAAAAABDANBgkqhkiG9w0BAQsFADBLMRMwEQYKCZImiZPyLGQBGRYDY29tMRMwEQYKCZImiZPyLGQBGRYDdGJ0MR8wHQYDVQQDExZ0YnQtV0lOLTk1NkNRT1NTSlRGLUNBMB4XDTI0MDIyMDIzNTI1N1oXDTI1MDIxOTIzNTI1N1owADCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAJ00MTGuGhl5P64ImcfGQKIs3R-hqDwlkNshrLry4KdHoBRg6lNJhlZ7TUdI3dMf67WL1GMXLVOXhLlj5T8xBIDxPCLL280JZmUjA7BCgNGAnZHIgcO-wceshXiIuu79D8tq7ZLGP105uPj44shPyxeMssHP2DEvnS-XHej1MnfD6AzNQ7Tww8bkQsebfoMDOg-RzmeWsWsAyENuYBBEZaOVWQ3Hlqv9RJrZdoaIgEOE3L9-Oc6YR2dP63oe8joB_JsTn3MxaVwqw_awZkxGTNx22iL39efpINlFlj1tFM67JpMvhaGowjGeMw3xMhdkNN5MlVQHmybc2uFFr-cCjJ0CAwEAAaOCAqswggKnMD0GCSsGAQQBgjcVBwQwMC4GJisGAQQBgjcVCIX6r0CFv7wWhIGPKIKV-lSGo6d_NIK2wQ-E-tJbAgFkAgECMB8GA1UdJQQYMBYGCisGAQQBgjcUAgIGCCsGAQUFBwMCMA4GA1UdDwEB_wQEAwIFoDApBgkrBgEEAYI3FQoEHDAaMAwGCisGAQQBgjcUAgIwCgYIKwYBBQUHAwIwHQYDVR0OBBYEFPEzFpOM5j5PtsqhmITshH4uqOgHMCgGA1UdEQEB_wQeMBygGgYKKwYBBAGCNxQCA6AMDAp0MkB0YnQuY29tMB8GA1UdIwQYMBaAFPism564p7aTWMNGJ3pmWTRwy0CtMIHYBgNVHR8EgdAwgc0wgcqggceggcSGgcFsZGFwOi8vL0NOPXRidC1XSU4tOTU2Q1FPU1NKVEYtQ0EsQ049V0lOLTk1NkNRT1NTSlRGLENOPUNEUCxDTj1QdWJsaWMlMjBLZXklMjBTZXJ2aWNlcyxDTj1TZXJ2aWNlcyxDTj1Db25maWd1cmF0aW9uLERDPXRidCxEQz1jb20_Y2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdD9iYXNlP29iamVjdENsYXNzPWNSTERpc3RyaWJ1dGlvblBvaW50MIHEBggrBgEFBQcBAQSBtzCBtDCBsQYIKwYBBQUHMAKGgaRsZGFwOi8vL0NOPXRidC1XSU4tOTU2Q1FPU1NKVEYtQ0EsQ049QUlBLENOPVB1YmxpYyUyMEtleSUyMFNlcnZpY2VzLENOPVNlcnZpY2VzLENOPUNvbmZpZ3VyYXRpb24sREM9dGJ0LERDPWNvbT9jQUNlcnRpZmljYXRlP2Jhc2U_b2JqZWN0Q2xhc3M9Y2VydGlmaWNhdGlvbkF1dGhvcml0eTANBgkqhkiG9w0BAQsFAAOCAQEALrbljamlyCDGcTjdpwlaxuoB24J9Y2mBSS54XvLha0pqTalSbB7rYxUfRQHfwdgsT_enIr0YENxOucU6XaYMqJPijBl9IxPAZtryCdpfq2JbSAYcYWZAM6ileb9-IwzN1YkgMoP0ePQnJnLWla8DwlypBb3RL8gPq1Tgh657BnLDI_KtxXXhzjc8F65e62X_tiZTYF3arzUi8d_27fTMMu31Q15wbyc0nqPshWqeREjIBgJANLDredzacfkktFMYP3SzKCjmdv2Agpk2UJj4YHqR6PM4HWEEMbZsccLup94eX7e07LbNLgknOHB11_STJXk6S1WOo34heqPVKJQc9w)

![image](https://github.com/user-attachments/assets/1244a059-b99f-4a39-8787-1a076d303b95)

# The tool

Basially, you need to write a similar asn1 data visualizer, but for the terminal. You can take the [jless](https://github.com/PaulJuliusMartinez/jless) as an inspiration.
